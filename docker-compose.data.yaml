version: "3.9"
services:

  data:
    image: ghcr.io/delvtech/elf-simulations/elf-simulations:${ELFPY_TAG}
    profiles:
      - "data"
    working_dir: /app/
    command: /bin/sh -c "python elfpy/data/acquire_data.py"
    depends_on:
      - ethereum
      - artifacts
    # This file sets postgres information
    env_file:
      - .env
    # These environment variables are connecting to other necessary containers
    environment:
      - CONTRACTS_URL=${ARTIFACTS_URL}/addresses.json
      - ETHEREUM_NODE=${RPC_URL}

  username-reg:
    image: ghcr.io/delvtech/elf-simulations/elf-simulations:${ELFPY_TAG}
    profiles:
      - "data"
    working_dir: /app/
    command: /bin/sh -c "python elfpy/data/register_username_server.py"
    # This file sets postgres information
    env_file:
      - .env

volumes:
  artifacts:
